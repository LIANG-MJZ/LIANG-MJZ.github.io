# GPIO的八种工作模式

1、上拉输入：IO口在无输入的情况下，保持高电平。

2、下拉输入：IO口在无输入的情况下，保持低电平。

3、浮空输入：浮空输入状态下，IO的电平状态是不确定的，完全由外部输入决定，如果在该引脚悬空的情况下，读取该端口的电平是不确定的。

4、模拟输入：输入信号不经施密特触发器直接接入，输入信号为模拟量而非数字量，其余输入方式输入数字量。

5、推挽输出：可以输出高、低电平，连接数字器件；推挽结构一般是指两个三极管分别受两个互补信号的控制，总是在	 一个三极管导通的时候另一个截止。高低电平由IC的电源决定。导通损耗小、效率高。输出既可以向负载灌电流，也	 可以从负载抽取电流。推拉式输出级既提高电路的负载能力，又提高开关速度。

6、开漏输出：输出端相当于三极管的集电极，要得到高电平状态需要上拉电阻才行。适合于做电流型的驱动，其吸收电流的能力相对强（一般20mA以内）。开漏形式的电路有以下几个特点：

7、利用外部电路的驱动能力，减少IC内部的驱动。当IC内部MOSFET导通时，驱动电流是从外部的VCC流经上拉电阻、MOSFET到GND。IC内部仅需很小的栅极驱动电流。

8、一般来说，开漏是用来连接不同电平的器件，匹配电平用的，因为开漏引脚不连接外部的上拉电阻时，只能输出低电	 平，如果需要同时具备输出高电平的功能，则需要接上拉电阻，很好的一个优点是通过改变上拉电源的电压，便可以	 改变传输电平。比如加上上拉电阻就可以提供TTL/CMOS电平输出等。（上拉电阻的阻值决定了逻辑电平转换的速	 	 度。阻值越大，速度越低功耗越小，所以负载电阻的选择要兼顾功耗和速度。）

9、开漏输出提供了灵活的输出方式，但是也有其弱点，就是带来上升沿的延时。因为上升沿是通过外接上拉无源电阻对	 负载充电，所以当电阻选择小时延时就小，但功耗大；反之延时大功耗小。所以如果对延时有要求，则建议用下降沿	 输出。

10、可以将多个开漏输出连接到一条线上。通过一只上拉电阻，在不增加任何器件的情况下，形成“与逻辑”关系，即“线		与”。可以简单的理解为：在所有引脚连在一起时，外接一上拉电阻，如果有一个引脚输出为逻辑0，相当于接地，与		之并联的回路“相当于被一根导线短路”，所以外电路逻辑电平便为0，只有都为高电平时，与的结果才为逻辑1。

11、复用推挽输出：此时IO受内部外设控制，比如定时器的PWM,比如SPI的MOSI,MISO等。 而普通的推挽输出，则IO受		ODR控制。

12、复用开漏输出：参考复用推挽。

## 

# 总结在STM32中选用IO模式

1、浮空输入GPIO_IN_FLOATING ——浮空输入，可以做KEY识别，RX1。

2、带上拉输入GPIO_IPU——IO内部上拉电阻输入。

3、带下拉输入GPIO_IPD—— IO内部下拉电阻输入。

4、模拟输入GPIO_AIN ——应用ADC模拟输入，或者低功耗下省电。

5、开漏输出GPIO_OUT_OD ——IO输出0接GND，IO输出1，悬空，需要外接上拉电阻，才能实现输出高电平。当输出为1时，IO口的状态由上拉电阻拉高电平，但由于是开漏输出模式，这样IO口也就可以由外部电路改变为低电平或不变。可以读IO输入电平变化，实现C51的IO双向功能。

6、推挽输出GPIO_OUT_PP ——IO输出0-接GND， IO输出1 -接VCC，读输入值是未知的。

7、复用功能的推挽输出GPIO_AF_PP ——片内外设功能（I2C的SCL,SDA）。

8、复用功能的开漏输出GPIO_AF_OD——片内外设功能（TX1,MOSI,MISO.SCK.SS）。